<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#dc3545">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Tokyo Area Guide</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22skyblue%22/><text y=%22.9em%22 font-size=%2290%22>üóº</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22skyblue%22/><text y=%22.9em%22 font-size=%2290%22>üóº</text></svg>">

    <style>

        body {
            background-color: #000000;
            color: #ffffff;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        
        /* ÂøÖË¶Å„Å´Âøú„Åò„Å¶ËøΩÂä†„ÅÆ„Çπ„Çø„Ç§„É´„Çí„Åì„Åì„Å´Ë®òËø∞ */
    </style>

</head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#121212">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Tokyo Guide">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="description" content="Tokyo Area Model Course Guide">
    <title>Tokyo Area Guide</title>
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon-180x180.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    
    <!-- Web App Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <style>
        :root {
            --primary: #e53935;
            --secondary: #1e88e5;
            --background: #121212;
            --text: #e0e0e0;
            --card-bg: #1e1e1e;
            --header-bg: linear-gradient(135deg, #c62828, #0d47a1);
            --button-bg: rgba(255,255,255,0.1);
            --button-text: #e0e0e0;
            --tab-bg: #333333;
            --tab-text: #e0e0e0;
            --tab-active-bg: var(--secondary);
            --tab-active-text: #ffffff;
            --category-bg: #333333;
            --category-text: #e0e0e0;
            --category-active-bg: var(--primary);
            --category-active-text: #ffffff;
            --nature: #2e7d32;
            --culture: #e65100;
            --urban: #1565c0;
            --food: #7b1fa2;
        }

        [data-theme="light"] {
            --background: #f5f5f5;
            --text: #212121;
            --card-bg: #ffffff;
            --header-bg: linear-gradient(135deg, var(--primary), var(--secondary));
            --button-bg: rgba(255,255,255,0.2);
            --button-text: #ffffff;
            --tab-bg: #e0e0e0;
            --tab-text: #212121;
            --category-bg: #ffffff;
            --category-text: #212121;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--background);
            margin: 0;
            padding: 0;
            -webkit-text-size-adjust: 100%;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior: none;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background: var(--header-bg);
            color: white;
            padding: 1.5rem 1rem;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        h1 {
            margin: 0;
            font-size: 1.8rem;
            font-weight: 600;
        }

        .subtitle {
            font-weight: 300;
            margin: 0.5rem 0 1rem;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin: 1rem 0;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 0.5rem 1rem;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .theme-btn {
            background: var(--button-bg);
            color: var(--button-text);
        }

        .lang-btn {
            background: var(--button-bg);
            color: var(--button-text);
        }

        .container {
            max-width: 1200px;
            margin: 1rem auto;
            padding: 0 1rem;
            width: 100%;
            box-sizing: border-box;
            flex: 1;
        }

        .tab-container {
            display: flex;
            margin-bottom: 1rem;
            overflow-x: auto;
            gap: 0.3rem;
            scrollbar-width: none;
            -webkit-overflow-scrolling: touch;
            padding-bottom: 2px;
        }

        .tab-container::-webkit-scrollbar {
            display: none;
        }

        .tab {
            padding: 0.5rem 1rem;
            background: var(--tab-bg);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            color: var(--tab-text);
            transition: all 0.2s;
            white-space: nowrap;
            flex-shrink: 0;
            -webkit-tap-highlight-color: transparent;
        }

        .tab.active {
            background: var(--tab-active-bg);
            color: var(--tab-active-text);
        }

        .category-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .category-btn {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            border: 1px solid #ddd;
            background: var(--category-bg);
            cursor: pointer;
            color: var(--category-text);
            transition: all 0.2s;
            font-size: 0.9rem;
            -webkit-tap-highlight-color: transparent;
        }

        .category-btn.active {
            background: var(--category-active-bg);
            color: var(--category-active-text);
            border-color: transparent;
        }

        .spot-card {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }

        .nature-bg { border-left: 4px solid var(--nature); }
        .culture-bg { border-left: 4px solid var(--culture); }
        .urban-bg { border-left: 4px solid var(--urban); }
        .food-bg { border-left: 4px solid var(--food); }

        .spot-title {
            color: var(--primary);
            margin-top: 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            padding-bottom: 0.5rem;
            font-weight: 600;
        }

        .spot-meta {
            display: flex;
            gap: 0.8rem;
            margin: 0.8rem 0;
            font-size: 0.9rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .direction-tag {
            background: var(--secondary);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.8rem;
        }

        .category-tag {
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.8rem;
            color: white;
        }

        .nature-tag { background: var(--nature); }
        .culture-tag { background: var(--culture); }
        .urban-tag { background: var(--urban); }
        .food-tag { background: var(--food); }

        .model-course {
            background: rgba(0,0,0,0.05);
            padding: 1rem;
            border-radius: 4px;
            margin: 1rem 0;
        }

        .course-step {
            margin-bottom: 0.5rem;
            padding-left: 1rem;
            position: relative;
        }

        .course-step:before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
            color: var(--primary);
        }

        .spot-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 4px;
            margin: 0.8rem 0;
            display: block;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            font-size: 0.9rem;
        }

        .no-results {
            text-align: center;
            padding: 2rem;
            color: var(--text);
            opacity: 0.7;
        }

        .scroll-to-top {
            display: block;
            width: 100%;
            padding: 12px;
            margin: 20px 0;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            text-align: center;
            transition: background-color 0.3s;
            -webkit-tap-highlight-color: transparent;
        }

        footer {
            background-color: var(--card-bg);
            padding: 20px;
            text-align: center;
            border-top: 1px solid rgba(0,0,0,0.1);
            margin-top: 30px;
        }

        footer a {
            color: var(--secondary);
            text-decoration: none;
        }

        .install-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            cursor: pointer;
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            -webkit-tap-highlight-color: transparent;
            animation: pulse 2s infinite;
        }

        .install-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--header-bg);
            color: white;
            padding: 15px;
            display: none;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
        }

        .install-banner-text {
            flex: 1;
            margin-right: 15px;
        }

        .install-banner-btn {
            background: white;
            color: var(--primary);
            border: none;
            border-radius: 4px;
            padding: 8px 15px;
            font-weight: bold;
            cursor: pointer;
        }

        .install-banner-close {
            background: transparent;
            color: white;
            border: none;
            margin-left: 10px;
            font-size: 1.2rem;
            cursor: pointer;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .splash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--header-bg);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            transition: opacity 0.3s;
        }

        .splash-icon {
            width: 120px;
            height: 120px;
            margin-bottom: 20px;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxOTIgMTkyIj48cmVjdCB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgZmlsbD0iIzEyMTIxMiIvPjxwYXRoIGQ9Ik05NiwzMkw0OCwxMjB2OTZoOTZ2LTk2WiIgZmlsbD0iI2U1MzkzNSIvPjxwYXRoIGQ9Ik05NiwzMkwxNDQsMTIwdjk2SDk2WiIgZmlsbD0iI2M2MjgyOCIvPjxwYXRoIGQ9Ik05NiwzMkw0OCwxMjBoOTZaIiBmaWxsPSIjZmZjMTA3Ii8+PC9zdmc+');
            background-size: contain;
        }

        .splash-title {
            color: white;
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .splash-subtitle {
            color: rgba(255,255,255,0.8);
            font-size: 1rem;
        }

        @media (min-width: 768px) {
            .spot-card {
                display: grid;
                grid-template-columns: 1fr 2fr;
                gap: 1.5rem;
            }
            
            h1 {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            header {
                padding: 1rem;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            .subtitle {
                font-size: 0.9rem;
            }
        }

        /* iOS specific styles */
        @supports (-webkit-touch-callout: none) {
            header {
                padding-top: max(1.5rem, env(safe-area-inset-top));
            }
            
            body {
                padding-bottom: env(safe-area-inset-bottom);
            }
            
            .install-btn {
                bottom: calc(20px + env(safe-area-inset-bottom));
            }
            
            .install-banner {
                padding-bottom: calc(15px + env(safe-area-inset-bottom));
            }
        }
    </style>
</head>
<body data-theme="dark">
    <div class="splash" id="splash">
        <div class="splash-icon"></div>
        <h1 class="splash-title">Tokyo Area Guide</h1>
        <p class="splash-subtitle">Loading...</p>
    </div>

    <header>
        <h1 id="appTitle">Tokyo Area Model Course Guide</h1>
        <p class="subtitle" id="appSubtitle">10 Selected Popular Spots</p>
        
        <div class="controls">
            <button class="control-btn theme-btn" id="themeBtn">
                <span id="themeIcon">‚òÄÔ∏è</span>
                <span id="themeText">Light Mode</span>
            </button>
            <button class="control-btn lang-btn" id="langBtn">
                <span id="langText">Êó•Êú¨Ë™û</span>
            </button>
        </div>
    </header>

    <div class="container">
        <div class="tab-container" id="directionTabs"></div>
        <div class="category-filter" id="categoryFilters"></div>
        <div id="spots-container"></div>
    </div>

    <button id="scrollToTopBtn" class="scroll-to-top">‚Üë Back to Top</button>
    <button id="installBtn" class="install-btn">Ôºã</button>
    
    <div class="install-banner" id="installBanner">
        <div class="install-banner-text" id="installBannerText">Add Tokyo Guide to your home screen for full experience</div>
        <button class="install-banner-btn" id="installBannerBtn">Install</button>
        <button class="install-banner-close" id="installBannerClose">√ó</button>
    </div>

    <footer>
        <div style="margin-bottom: 10px;">Contact me</div>
        <div><a href="mailto:mementomorikatsu@gmail.com">mementomorikatsu@gmail.com</a></div>
    </footer>

    <script>
        // „Ç¢„Éó„É™„ÅÆÁä∂ÊÖãÁÆ°ÁêÜ
        let currentTheme = localStorage.getItem('theme') || 'dark';
        let currentLang = localStorage.getItem('lang') || 'en';
        let currentFilter = {
            direction: 'all',
            category: 'all'
        };
        
        // ÁøªË®≥„Éá„Éº„Çø
        const translations = {
            en: {
                appTitle: "Tokyo Area Model Course Guide",
                appSubtitle: "10 Selected Popular Spots",
                directions: { all: "All", east: "East", west: "West", south: "South", north: "North", central: "Central" },
                categories: { all: "All", nature: "Nature", culture: "Culture", urban: "Urban", food: "Food" },
                time: "Time", budget: "Budget", bestSeason: "Best Season", modelCourse: "Model Course",
                darkMode: "Light Mode", lightMode: "Dark Mode", switchLang: "Êó•Êú¨Ë™û",
                noResults: "No spots found", scrollToTop: "‚Üë Back to Top",
                installPrompt: "Add Tokyo Guide to your home screen for full experience",
                installBtn: "Install",
                iosInstall: "Tap Share, then 'Add to Home Screen'"
            },
            ja: {
                appTitle: "Êù±‰∫¨Âë®Ëæ∫„É¢„Éá„É´„Ç≥„Éº„Çπ„Ç¨„Ç§„Éâ",
                appSubtitle: "‰∫∫Ê∞ó„Çπ„Éù„ÉÉ„ÉàÂé≥ÈÅ∏10ÈÅ∏",
                directions: { all: "„Åô„Åπ„Å¶", east: "Êù±", west: "Ë•ø", south: "Âçó", north: "Âåó", central: "ÈÉΩÂøÉ" },
                categories: { all: "„Åô„Åπ„Å¶", nature: "Ëá™ÁÑ∂", culture: "ÊñáÂåñ", urban: "ÈÉΩ‰ºö", food: "È£ü‰∫ã" },
                time: "ÊôÇÈñì", budget: "‰∫àÁÆó", bestSeason: "„Åä„Åô„Åô„ÇÅÊôÇÊúü", modelCourse: "„É¢„Éá„É´„Ç≥„Éº„Çπ",
                darkMode: "„É©„Ç§„Éà„É¢„Éº„Éâ", lightMode: "„ÉÄ„Éº„ÇØ„É¢„Éº„Éâ", switchLang: "English",
                noResults: "Ë©≤ÂΩì„Åô„Çã„Çπ„Éù„ÉÉ„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì", scrollToTop: "‚Üë „Éö„Éº„Ç∏„Éà„ÉÉ„Éó„Å´Êàª„Çã",
                installPrompt: "„Éõ„Éº„É†ÁîªÈù¢„Å´ËøΩÂä†„Åó„Å¶„Éï„É´Ê©üËÉΩ„ÇíÂà©Áî®„Åó„Åæ„Åó„Çá„ÅÜ",
                installBtn: "„Ç§„É≥„Çπ„Éà„Éº„É´",
                iosInstall: "ÂÖ±Êúâ„Çí„Çø„ÉÉ„Éó„Åó„ÄÅ'„Éõ„Éº„É†ÁîªÈù¢„Å´ËøΩÂä†'„ÇíÈÅ∏Êäû"
            }
        };

        // „Çπ„Éù„ÉÉ„Éà„Éá„Éº„Çø
        const spots = [
            {
                id: 1,
                titles: {
                    en: "Asakusa & Tokyo Skytree",
                    ja: "ÊµÖËçâÔºÜÊù±‰∫¨„Çπ„Ç´„Ç§„ÉÑ„É™„Éº"
                },
                descriptions: {
                    en: "Experience traditional Japan in Asakusa with Sensoji Temple, then visit the modern Tokyo Skytree for panoramic views.",
                    ja: "ÊµÖËçâ„ÅÆÊµÖËçâÂØ∫„Åß‰ºùÁµ±ÁöÑ„Å™Êó•Êú¨„Çí‰ΩìÈ®ì„Åó„ÄÅ„Åù„ÅÆÂæåÁèæ‰ª£ÁöÑ„Å™Êù±‰∫¨„Çπ„Ç´„Ç§„ÉÑ„É™„Éº„Åß„Éë„Éé„É©„Éû„Éì„É•„Éº„ÇíÊ•Ω„Åó„ÇÅ„Åæ„Åô„ÄÇ"
                },
                direction: "east",
                categories: ["culture", "urban"],
                image: "https://images.unsplash.com/photo-1542051841857-5f90071e7989?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80",
                timeRequired: {
                    en: "4-5 hours",
                    ja: "4-5ÊôÇÈñì"
                },
                budget: {
                    en: "¬•3,000-¬•5,000",
                    ja: "3,000ÂÜÜÔΩû5,000ÂÜÜ"
                },
                bestSeason: {
                    en: "Spring, Autumn",
                    ja: "Êò•„ÄÅÁßã"
                },
                modelCourses: {
                    en: [
                        "Start at Sensoji Temple (1-2 hours)",
                        "Walk through Nakamise shopping street",
                        "Take a river cruise from Asakusa to Odaiba (optional)",
                        "Visit Tokyo Skytree (2-3 hours)"
                    ],
                    ja: [
                        "ÊµÖËçâÂØ∫„Åã„Çâ„Çπ„Çø„Éº„ÉàÔºà1-2ÊôÇÈñìÔºâ",
                        "‰ª≤Ë¶ã‰∏ñÈÄö„Çä„ÇíÊï£Á≠ñ",
                        "ÊµÖËçâ„Åã„Çâ„ÅäÂè∞Â†¥„Åæ„ÅßÊ∞¥‰∏ä„Éê„Çπ„ÅßÁßªÂãïÔºà„Ç™„Éó„Ç∑„Éß„É≥Ôºâ",
                        "Êù±‰∫¨„Çπ„Ç´„Ç§„ÉÑ„É™„Éº„ÇíË®™ÂïèÔºà2-3ÊôÇÈñìÔºâ"
                    ]
                }
            },
            {
                id: 2,
                titles: {
                    en: "Shibuya & Harajuku",
                    ja: "Ê∏ãË∞∑ÔºÜÂéüÂÆø"
                },
                descriptions: {
                    en: "Explore Tokyo's youth culture in Harajuku's Takeshita Street and experience the famous Shibuya Crossing.",
                    ja: "ÂéüÂÆø„ÅÆÁ´π‰∏ãÈÄö„Çä„ÅßÊù±‰∫¨„ÅÆËã•ËÄÖÊñáÂåñ„ÇíÊé¢Á¥¢„Åó„ÄÅÊúâÂêç„Å™Ê∏ãË∞∑„Çπ„ÇØ„É©„É≥„Éñ„É´‰∫§Â∑ÆÁÇπ„Çí‰ΩìÈ®ì„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ"
                },
                direction: "central",
                categories: ["urban", "food"],
                image: "https://images.unsplash.com/photo-1542051841857-5f90071e7989?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80",
                timeRequired: {
                    en: "3-4 hours",
                    ja: "3-4ÊôÇÈñì"
                },
                budget: {
                    en: "¬•2,000-¬•10,000",
                    ja: "2,000ÂÜÜÔΩû10,000ÂÜÜ"
                },
                bestSeason: {
                    en: "All year",
                    ja: "ÈÄöÂπ¥"
                },
                modelCourses: {
                    en: [
                        "Start at Meiji Shrine (30-60 mins)",
                        "Explore Takeshita Street in Harajuku (1 hour)",
                        "Walk to Shibuya via Cat Street",
                        "Experience Shibuya Crossing and shopping (1-2 hours)"
                    ],
                    ja: [
                        "ÊòéÊ≤ªÁ•ûÂÆÆ„Åã„Çâ„Çπ„Çø„Éº„ÉàÔºà30-60ÂàÜÔºâ",
                        "ÂéüÂÆø„ÅÆÁ´π‰∏ãÈÄö„Çä„ÇíÊé¢Á¥¢Ôºà1ÊôÇÈñìÔºâ",
                        "„Ç≠„É£„ÉÉ„Éà„Çπ„Éà„É™„Éº„Éà„ÇíÈÄö„Å£„Å¶Ê∏ãË∞∑„Å∏",
                        "Ê∏ãË∞∑„Çπ„ÇØ„É©„É≥„Éñ„É´‰∫§Â∑ÆÁÇπ„Å®„Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞„Çí‰ΩìÈ®ìÔºà1-2ÊôÇÈñìÔºâ"
                    ]
                }
            },
            {
                id: 3,
                titles: {
                    en: "Shinjuku Gyoen & Golden Gai",
                    ja: "Êñ∞ÂÆøÂæ°ËãëÔºÜ„Ç¥„Éº„É´„Éá„É≥Ë°ó"
                },
                descriptions: {
                    en: "Enjoy nature at Shinjuku Gyoen National Garden, then experience Tokyo's nightlife in Golden Gai.",
                    ja: "Êñ∞ÂÆøÂæ°Ëãë„ÅßËá™ÁÑ∂„ÇíÊ•Ω„Åó„Çì„Å†Âæå„ÄÅ„Ç¥„Éº„É´„Éá„É≥Ë°ó„ÅßÊù±‰∫¨„ÅÆ„Éä„Ç§„Éà„É©„Ç§„Éï„Çí‰ΩìÈ®ì„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ"
                },
                direction: "central",
                categories: ["nature", "urban"],
                image: "https://images.unsplash.com/photo-1542051841857-5f90071e7989?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80",
                timeRequired: {
                    en: "3-5 hours",
                    ja: "3-5ÊôÇÈñì"
                },
                budget: {
                    en: "¬•1,000-¬•8,000",
                    ja: "1,000ÂÜÜÔΩû8,000ÂÜÜ"
                },
                bestSeason: {
                    en: "Spring (cherry blossoms), Autumn (foliage)",
                    ja: "Êò•ÔºàÊ°úÔºâ„ÄÅÁßãÔºàÁ¥ÖËëâÔºâ"
                },
                modelCourses: {
                    en: [
                        "Visit Shinjuku Gyoen (1-2 hours)",
                        "Explore Omoide Yokocho (Memory Lane) for lunch",
                        "Visit Tokyo Metropolitan Government Building observatory (free)",
                        "Experience Golden Gai at night (1-2 hours)"
                    ],
                    ja: [
                        "Êñ∞ÂÆøÂæ°Ëãë„ÇíË®™ÂïèÔºà1-2ÊôÇÈñìÔºâ",
                        "ÊÄù„ÅÑÂá∫Ê®™‰∏Å„ÅßÊòºÈ£ü",
                        "Êù±‰∫¨ÈÉΩÂ∫ÅÂ±ïÊúõÂÆ§„ÇíË®™ÂïèÔºàÁÑ°ÊñôÔºâ",
                        "Â§ú„Å´„Ç¥„Éº„É´„Éá„É≥Ë°ó„Çí‰ΩìÈ®ìÔºà1-2ÊôÇÈñìÔºâ"
                    ]
                }
            },
            {
                id: 4,
                titles: {
                    en: "Odaiba & TeamLab Borderless",
                    ja: "„ÅäÂè∞Â†¥ÔºÜ„ÉÅ„Éº„É†„É©„Éú„Éú„Éº„ÉÄ„É¨„Çπ"
                },
                descriptions: {
                    en: "Experience futuristic Tokyo in Odaiba with its shopping malls and digital art museum.",
                    ja: "„Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞„É¢„Éº„É´„Å®„Éá„Ç∏„Çø„É´„Ç¢„Éº„Éà„Éü„É•„Éº„Ç∏„Ç¢„É†„Åå„ÅÇ„Çã„ÅäÂè∞Â†¥„ÅßÊú™Êù•ÁöÑ„Å™Êù±‰∫¨„Çí‰ΩìÈ®ì„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ"
                },
                direction: "east",
                categories: ["urban", "culture"],
                image: "https://images.unsplash.com/photo-1542051841857-5f90071e7989?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80",
                timeRequired: {
                    en: "4-6 hours",
                    ja: "4-6ÊôÇÈñì"
                },
                budget: {
                    en: "¬•3,000-¬•10,000",
                    ja: "3,000ÂÜÜÔΩû10,000ÂÜÜ"
                },
                bestSeason: {
                    en: "All year (indoor attractions)",
                    ja: "ÈÄöÂπ¥ÔºàÂ±ãÂÜÖ„Ç¢„Éà„É©„ÇØ„Ç∑„Éß„É≥Ôºâ"
                },
                modelCourses: {
                    en: [
                        "Visit TeamLab Borderless (2-3 hours)",
                        "Explore Palette Town and VenusFort",
                        "See the giant Gundam statue",
                        "Enjoy sunset views of Rainbow Bridge"
                    ],
                    ja: [
                        "„ÉÅ„Éº„É†„É©„Éú„Éú„Éº„ÉÄ„É¨„Çπ„ÇíË®™ÂïèÔºà2-3ÊôÇÈñìÔºâ",
                        "„Éë„É¨„ÉÉ„Éà„Çø„Ç¶„É≥„Å®„É¥„Ç£„Éº„Éä„Çπ„Éï„Ç©„Éº„Éà„ÇíÊé¢Á¥¢",
                        "Â∑®Â§ß„Ç¨„É≥„ÉÄ„É†ÂÉè„ÇíË¶ã„Çã",
                        "„É¨„Ç§„É≥„Éú„Éº„Éñ„É™„ÉÉ„Ç∏„ÅÆÂ§ïÊó•„ÇíÊ•Ω„Åó„ÇÄ"
                    ]
                }
            },
            {
                id: 5,
                titles: {
                    en: "Akihabara Electric Town",
                    ja: "ÁßãËëâÂéüÈõªÊ∞óË°ó"
                },
                descriptions: {
                    en: "Discover Tokyo's otaku culture in Akihabara, the center of anime, manga, and electronics.",
                    ja: "„Ç¢„Éã„É°„ÄÅ„Éû„É≥„Ç¨„ÄÅÈõªÂ≠êÊ©üÂô®„ÅÆ‰∏≠ÂøÉÂú∞„Åß„ÅÇ„ÇãÁßãËëâÂéü„ÅßÊù±‰∫¨„ÅÆ„Ç™„Çø„ÇØÊñáÂåñ„ÇíÁô∫Ë¶ã„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ"
                },
                direction: "central",
                categories: ["urban", "culture"],
                image: "https://images.unsplash.com/photo-1542051841857-5f90071e7989?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80",
                timeRequired: {
                    en: "3-5 hours",
                    ja: "3-5ÊôÇÈñì"
                },
                budget: {
                    en: "¬•2,000-¬•20,000",
                    ja: "2,000ÂÜÜÔΩû20,000ÂÜÜ"
                },
                bestSeason: {
                    en: "All year",
                    ja: "ÈÄöÂπ¥"
                },
                modelCourses: {
                    en: [
                        "Explore electronics stores like Yodobashi Camera",
                        "Visit anime and manga shops",
                        "Try a maid cafe (optional)",
                        "Browse hobby and collectible stores"
                    ],
                    ja: [
                        "„É®„Éâ„Éê„Ç∑„Ç´„É°„É©„Å™„Å©„ÅÆÈõªÊ∞óÂ∫ó„ÇíÊé¢Á¥¢",
                        "„Ç¢„Éã„É°„Å®„Éû„É≥„Ç¨„ÅÆÂ∫ó„ÇíË®™Âïè",
                        "„É°„Ç§„Éâ„Ç´„Éï„Çß„ÇíË©¶„ÅôÔºà„Ç™„Éó„Ç∑„Éß„É≥Ôºâ",
                        "„Éõ„Éì„Éº„Å®„Ç≥„É¨„ÇØ„Çø„Éñ„É´„Çπ„Éà„Ç¢„ÇíÈñ≤Ë¶ß"
                    ]
                }
            },
            {
                id: 6,
                titles: {
                    en: "Ueno Park & Museums",
                    ja: "‰∏äÈáéÂÖ¨ÂúíÔºÜÂçöÁâ©È§®"
                },
                descriptions: {
                    en: "Enjoy culture and nature at Ueno Park, home to several major museums and Ueno Zoo.",
                    ja: "„ÅÑ„Åè„Å§„Åã„ÅÆ‰∏ªË¶Å„Å™ÂçöÁâ©È§®„Å®‰∏äÈáéÂãïÁâ©Âúí„Åå„ÅÇ„Çã‰∏äÈáéÂÖ¨Âúí„ÅßÊñáÂåñ„Å®Ëá™ÁÑ∂„ÇíÊ•Ω„Åó„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ"
                },
                direction: "east",
                categories: ["culture", "nature"],
                image: "https://images.unsplash.com/photo-1542051841857-5f90071e7989?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80",
                timeRequired: {
                    en: "4-6 hours",
                    ja: "4-6ÊôÇÈñì"
                },
                budget: {
                    en: "¬•1,000-¬•5,000",
                    ja: "1,000ÂÜÜÔΩû5,000ÂÜÜ"
                },
                bestSeason: {
                    en: "Spring (cherry blossoms), Autumn",
                    ja: "Êò•ÔºàÊ°úÔºâ„ÄÅÁßã"
                },
                modelCourses: {
                    en: [
                        "Visit Ueno Zoo (1-2 hours)",
                        "Explore Tokyo National Museum (1-2 hours)",
                        "Walk through Shinobazu Pond",
                        "Visit Ameya-Yokocho market"
                    ],
                    ja: [
                        "‰∏äÈáéÂãïÁâ©Âúí„ÇíË®™ÂïèÔºà1-2ÊôÇÈñìÔºâ",
                        "Êù±‰∫¨ÂõΩÁ´ãÂçöÁâ©È§®„ÇíÊé¢Á¥¢Ôºà1-2ÊôÇÈñìÔºâ",
                        "‰∏çÂøçÊ±†„ÇíÊï£Ê≠©",
                        "„Ç¢„É°„É§Ê®™‰∏ÅÂ∏ÇÂ†¥„ÇíË®™Âïè"
                    ]
                }
            },
            {
                id: 7,
                titles: {
                    en: "Tsukiji Outer Market & Ginza",
                    ja: "ÁØâÂú∞Â†¥Â§ñÂ∏ÇÂ†¥ÔºÜÈäÄÂ∫ß"
                },
                descriptions: {
                    en: "Experience fresh seafood at Tsukiji Outer Market, then explore the luxury shopping district of Ginza.",
                    ja: "ÁØâÂú∞Â†¥Â§ñÂ∏ÇÂ†¥„ÅßÊñ∞ÈÆÆ„Å™„Ç∑„Éº„Éï„Éº„Éâ„Çí‰ΩìÈ®ì„Åó„ÄÅ„Åù„ÅÆÂæåÈ´òÁ¥ö„Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞Âú∞Âå∫„ÅÆÈäÄÂ∫ß„ÇíÊé¢Á¥¢„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ"
                },
                direction: "central",
                categories: ["food", "urban"],
                image: "https://images.unsplash.com/photo-1542051841857-5f90071e7989?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80",
                timeRequired: {
                    en: "3-4 hours",
                    ja: "3-4ÊôÇÈñì"
                },
                budget: {
                    en: "¬•3,000-¬•20,000",
                    ja: "3,000ÂÜÜÔΩû20,000ÂÜÜ"
                },
                bestSeason: {
                    en: "All year",
                    ja: "ÈÄöÂπ¥"
                },
                modelCourses: {
                    en: [
                        "Have breakfast at Tsukiji Outer Market (1 hour)",
                        "Visit Hama-rikyu Gardens (30 mins)",
                        "Explore Ginza shopping district (1-2 hours)",
                        "Visit Itoya stationery store"
                    ],
                    ja: [
                        "ÁØâÂú∞Â†¥Â§ñÂ∏ÇÂ†¥„ÅßÊúùÈ£üÔºà1ÊôÇÈñìÔºâ",
                        "ÊµúÈõ¢ÂÆÆÊÅ©Ë≥úÂ∫≠Âúí„ÇíË®™ÂïèÔºà30ÂàÜÔºâ",
                        "ÈäÄÂ∫ß„Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞Âú∞Âå∫„ÇíÊé¢Á¥¢Ôºà1-2ÊôÇÈñìÔºâ",
                        "‰ºäÊù±Â±ãÊñáÂÖ∑Â∫ó„ÇíË®™Âïè"
                    ]
                }
            },
            {
                id: 8,
                titles: {
                    en: "Roppongi Hills & Mori Art Museum",
                    ja: "ÂÖ≠Êú¨Êú®„Éí„É´„Ç∫ÔºÜÊ£ÆÁæéË°ìÈ§®"
                },
                descriptions: {
                    en: "Enjoy art and city views at Roppongi Hills, Tokyo's premier art and entertainment complex.",
                    ja: "Êù±‰∫¨„ÅÆ‰∏ªË¶Å„Å™„Ç¢„Éº„Éà„Å®„Ç®„É≥„Çø„Éº„ÉÜ„Ç§„É≥„É°„É≥„Éà„Ç≥„É≥„Éó„É¨„ÉÉ„ÇØ„Çπ„Åß„ÅÇ„ÇãÂÖ≠Êú¨Êú®„Éí„É´„Ç∫„Åß„Ç¢„Éº„Éà„Å®ÈÉΩÂ∏Ç„ÅÆÊôØËâ≤„ÇíÊ•Ω„Åó„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ"
                },
                direction: "central",
                categories: ["culture", "urban"],
                image: "https://images.unsplash.com/photo-1542051841857-5f90071e7989?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80",
                timeRequired: {
                    en: "3-4 hours",
                    ja: "3-4ÊôÇÈñì"
                },
                budget: {
                    en: "¬•2,000-¬•8,000",
                    ja: "2,000ÂÜÜÔΩû8,000ÂÜÜ"
                },
                bestSeason: {
                    en: "All year",
                    ja: "ÈÄöÂπ¥"
                },
                modelCourses: {
                    en: [
                        "Visit Mori Art Museum (1-2 hours)",
                        "Go to Tokyo City View observation deck",
                        "Explore Roppongi Hills shopping",
                        "Visit nearby National Art Center"
                    ],
                    ja: [
                        "Ê£ÆÁæéË°ìÈ§®„ÇíË®™ÂïèÔºà1-2ÊôÇÈñìÔºâ",
                        "Êù±‰∫¨„Ç∑„ÉÜ„Ç£„Éì„É•„ÉºÂ±ïÊúõÂè∞„Å∏",
                        "ÂÖ≠Êú¨Êú®„Éí„É´„Ç∫„ÅÆ„Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞„ÇíÊé¢Á¥¢",
                        "Ëøë„Åè„ÅÆÂõΩÁ´ãÊñ∞ÁæéË°ìÈ§®„ÇíË®™Âïè"
                    ]
                }
            },
            {
                id: 9,
                titles: {
                    en: "Mount Takao",
                    ja: "È´òÂ∞æÂ±±"
                },
                descriptions: {
                    en: "Escape the city and hike Mount Takao, a popular nature spot just an hour from central Tokyo.",
                    ja: "ÈÉΩÂøÉ„Åã„Çâ„Çè„Åö„Åã1ÊôÇÈñì„ÅÆË∑ùÈõ¢„Å´„ÅÇ„Çã‰∫∫Ê∞ó„ÅÆËá™ÁÑ∂„Çπ„Éù„ÉÉ„Éà„ÄÅÈ´òÂ∞æÂ±±„Åß„Éè„Ç§„Ç≠„É≥„Ç∞„ÇíÊ•Ω„Åó„Åø„Åæ„Åó„Çá„ÅÜ„ÄÇ"
                },
                direction: "west",
                categories: ["nature"],
                image: "https://images.unsplash.com/photo-1542051841857-5f90071e7989?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80",
                timeRequired: {
                    en: "5-7 hours",
                    ja: "5-7ÊôÇÈñì"
                },
                budget: {
                    en: "¬•1,000-¬•3,000",
                    ja: "1,000ÂÜÜÔΩû3,000ÂÜÜ"
                },
                bestSeason: {
                    en: "Spring, Autumn",
                    ja: "Êò•„ÄÅÁßã"
                },
                modelCourses: {
                    en: [
                        "Take Keio Line to Takaosanguchi Station",
                        "Choose a hiking trail (1-3 hours)",
                        "Visit Yakuoin Temple at the summit",
                        "Try local specialties like tororo soba"
                    ],
                    ja: [
                        "‰∫¨ÁéãÁ∑ö„ÅßÈ´òÂ∞æÂ±±Âè£ÈßÖ„Å∏",
                        "„Éè„Ç§„Ç≠„É≥„Ç∞„Ç≥„Éº„Çπ„ÇíÈÅ∏ÊäûÔºà1-3ÊôÇÈñìÔºâ",
                        "Â±±È†Ç„ÅÆËñ¨ÁéãÈô¢„ÇíË®™Âïè",
                        "„Å®„Çç„Çç„Åù„Å∞„Å™„Å©„ÅÆÂú∞ÂÖÉ„ÅÆÂêçÁâ©„ÇíË©¶„Åô"
                    ]
                }
            },
            {
                id: 10,
                titles: {
                    en: "Yokohama Minato Mirai",
                    ja: "Ê®™Êµú„Åø„Å™„Å®„Åø„Çâ„ÅÑ"
                },
                descriptions: {
                    en: "Visit Yokohama's waterfront district with its museums, shopping, and iconic Ferris wheel.",
                    ja: "ÂçöÁâ©È§®„ÄÅ„Ç∑„Éß„ÉÉ„Éî„É≥„Ç∞„ÄÅË±°Âæ¥ÁöÑ„Å™Ë¶≥Ë¶ßËªä„Åå„ÅÇ„ÇãÊ®™Êµú„ÅÆ„Ç¶„Ç©„Éº„Çø„Éº„Éï„É≠„É≥„ÉàÂú∞Âå∫„ÇíË®™Âïè„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇ"
                },
                direction: "south",
                categories: ["urban", "culture"],
                image: "https://images.unsplash.com/photo-1542051841857-5f90071e7989?ixlib=rb-1.2.1&auto=format&fit=crop&w=1000&q=80",
                timeRequired: {
                    en: "4-6 hours",
                    ja: "4-6ÊôÇÈñì"
                },
                budget: {
                    en: "¬•3,000-¬•8,000",
                    ja: "3,000ÂÜÜÔΩû8,000ÂÜÜ"
                },
                bestSeason: {
                    en: "All year",
                    ja: "ÈÄöÂπ¥"
                },
                modelCourses: {
                    en: [
                        "Visit Cup Noodles Museum (1-2 hours)",
                        "Explore Red Brick Warehouse",
                        "Ride the Cosmo Clock 21 Ferris wheel",
                        "Walk along Yamashita Park"
                    ],
                    ja: [
                        "„Ç´„ÉÉ„Éó„Éå„Éº„Éâ„É´„Éü„É•„Éº„Ç∏„Ç¢„É†„ÇíË®™ÂïèÔºà1-2ÊôÇÈñìÔºâ",
                        "Ëµ§„É¨„É≥„Ç¨ÂÄâÂ∫´„ÇíÊé¢Á¥¢",
                        "„Ç≥„Çπ„É¢„ÇØ„É≠„ÉÉ„ÇØ21Ë¶≥Ë¶ßËªä„Å´‰πó„Çã",
                        "Â±±‰∏ãÂÖ¨Âúí„ÇíÊï£Ê≠©"
                    ]
                }
            }
        ];

        // Service WorkerÁôªÈå≤
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => {
                        console.log('ServiceWorker registration successful with scope: ', reg.scope);
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }

        // „Ç§„É≥„Çπ„Éà„Éº„É´„Éó„É≠„É≥„Éó„ÉàÂá¶ÁêÜ
        let deferredPrompt;
        const installBtn = document.getElementById('installBtn');
        const installBanner = document.getElementById('installBanner');
        const installBannerBtn = document.getElementById('installBannerBtn');
        const installBannerClose = document.getElementById('installBannerClose');
        const installBannerText = document.getElementById('installBannerText');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // „Ç§„É≥„Çπ„Éà„Éº„É´„Éú„Çø„É≥„ÇíË°®Á§∫
            installBtn.style.display = 'flex';
            
            // iOS„Å™„Å©PWA„Ç§„É≥„Çπ„Éà„Éº„É´„Çí„Çµ„Éù„Éº„Éà„Åó„Å¶„ÅÑ„Å™„ÅÑ„Éñ„É©„Ç¶„Ç∂„ÅÆÂ†¥Âêà
            if (isIOS() && !isInStandaloneMode()) {
                showIOSInstallBanner();
            }
            
            installBtn.addEventListener('click', async () => {
                installBtn.style.display = 'none';
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                console.log('User response:', outcome);
                deferredPrompt = null;
            });
        });

        window.addEventListener('appinstalled', () => {
            installBtn.style.display = 'none';
            installBanner.style.display = 'none';
            console.log('PWA installed successfully');
        });

        // iOS„Ç§„É≥„Çπ„Éà„Éº„É´„Éê„Éä„Éº„ÇíË°®Á§∫
        function showIOSInstallBanner() {
            if (!isInStandaloneMode()) {
                installBannerText.textContent = translations[currentLang].iosInstall;
                installBanner.style.display = 'flex';
            }
        }

        installBannerBtn.addEventListener('click', () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    } else {
                        console.log('User dismissed the install prompt');
                    }
                    deferredPrompt = null;
                });
            }
            installBanner.style.display = 'none';
        });

        installBannerClose.addEventListener('click', () => {
            installBanner.style.display = 'none';
        });

        // „Çπ„Éó„É©„ÉÉ„Ç∑„É•„Çπ„ÇØ„É™„Éº„É≥ÈùûË°®Á§∫
        function hideSplashScreen() {
            const splash = document.getElementById('splash');
            if (splash) {
                splash.style.opacity = '0';
                setTimeout(() => {
                    splash.style.display = 'none';
                }, 300);
            }
        }

        // iOS„Åã„Å©„ÅÜ„Åã„ÇíÂà§ÂÆö
        function isIOS() {
            return /iPad|iPhone|iPod/.test(navigator.userAgent) || 
                  (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
        }

        // „Çπ„Çø„É≥„Éâ„Ç¢„É≠„É≥„É¢„Éº„Éâ„Åã„Å©„ÅÜ„Åã„ÇíÂà§ÂÆö
        function isInStandaloneMode() {
            return window.matchMedia('(display-mode: standalone)').matches || 
                   window.navigator.standalone ||
                   document.referrer.includes('android-app://');
        }

        // „Ç¢„Éó„É™ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', function() {
            // „É¶„Éº„Ç∂„ÉºË®≠ÂÆö„Çí„É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Åã„ÇâË™≠„ÅøËæº„Åø
            const savedTheme = localStorage.getItem('theme');
            const savedLang = localStorage.getItem('lang');
            
            if (savedTheme) currentTheme = savedTheme;
            if (savedLang) currentLang = savedLang;
            
            setTimeout(hideSplashScreen, 1500);
            
            const themeBtn = document.getElementById('themeBtn');
            const themeIcon = document.getElementById('themeIcon');
            const themeText = document.getElementById('themeText');
            const langBtn = document.getElementById('langBtn');
            const langText = document.getElementById('langText');
            const appTitle = document.getElementById('appTitle');
            const appSubtitle = document.getElementById('appSubtitle');
            const directionTabs = document.getElementById('directionTabs');
            const categoryFilters = document.getElementById('categoryFilters');
            const spotsContainer = document.getElementById('spots-container');
            const scrollToTopBtn = document.getElementById('scrollToTopBtn');
            const splashTitle = document.querySelector('.splash-title');
            const splashSubtitle = document.querySelector('.splash-subtitle');

            if (splashTitle && splashSubtitle) {
                splashTitle.textContent = translations[currentLang].appTitle;
                splashSubtitle.textContent = translations[currentLang].appSubtitle;
            }

            document.documentElement.setAttribute('data-theme', currentTheme);
            updateUI();

            // iOS„Åß„Çπ„Çø„É≥„Éâ„Ç¢„É≠„É≥„É¢„Éº„Éâ„Åß„Å™„ÅÑÂ†¥Âêà„ÄÅ„Ç§„É≥„Çπ„Éà„Éº„É´„Éê„Éä„Éº„ÇíË°®Á§∫
            if (isIOS() && !isInStandaloneMode()) {
                setTimeout(showIOSInstallBanner, 5000);
            }

            themeBtn.addEventListener('click', function() {
                currentTheme = currentTheme === 'dark' ? 'light' : 'dark';
                document.documentElement.setAttribute('data-theme', currentTheme);
                localStorage.setItem('theme', currentTheme);
                updateThemeButton();
            });

            langBtn.addEventListener('click', function() {
                currentLang = currentLang === 'en' ? 'ja' : 'en';
                localStorage.setItem('lang', currentLang);
                updateUI();
                renderSpots();
            });

            scrollToTopBtn.addEventListener('click', function() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            function updateUI() {
                appTitle.textContent = translations[currentLang].appTitle;
                appSubtitle.textContent = translations[currentLang].appSubtitle;
                langText.textContent = translations[currentLang].switchLang;
                scrollToTopBtn.textContent = translations[currentLang].scrollToTop;
                installBannerText.textContent = translations[currentLang].installPrompt;
                installBannerBtn.textContent = translations[currentLang].installBtn;
                updateThemeButton();
                renderDirectionTabs();
                renderCategoryFilters();
                renderSpots();
            }

            function updateThemeButton() {
                if (currentTheme === 'dark') {
                    themeIcon.textContent = '‚òÄÔ∏è';
                    themeText.textContent = translations[currentLang].lightMode;
                } else {
                    themeIcon.textContent = 'üåô';
                    themeText.textContent = translations[currentLang].darkMode;
                }
            }

            function renderDirectionTabs() {
                directionTabs.innerHTML = '';
                Object.entries(translations[currentLang].directions).forEach(([key, text]) => {
                    const tab = document.createElement('button');
                    tab.className = `tab ${currentFilter.direction === key ? 'active' : ''}`;
                    tab.textContent = text;
                    tab.dataset.direction = key;
                    tab.addEventListener('click', () => {
                        currentFilter.direction = key;
                        renderDirectionTabs();
                        renderSpots();
                    });
                    directionTabs.appendChild(tab);
                });
            }

            function renderCategoryFilters() {
                categoryFilters.innerHTML = '';
                Object.entries(translations[currentLang].categories).forEach(([key, text]) => {
                    const btn = document.createElement('button');
                    btn.className = `category-btn ${currentFilter.category === key ? 'active' : ''}`;
                    btn.textContent = text;
                    btn.dataset.category = key;
                    btn.addEventListener('click', () => {
                        currentFilter.category = key;
                        renderCategoryFilters();
                        renderSpots();
                    });
                    categoryFilters.appendChild(btn);
                });
            }

            function renderSpots() {
                spotsContainer.innerHTML = '';

                const filteredSpots = spots.filter(spot => {
                    const directionMatch = currentFilter.direction === "all" || spot.direction === currentFilter.direction;
                    const categoryMatch = currentFilter.category === "all" || spot.categories.includes(currentFilter.category);
                    return directionMatch && categoryMatch;
                });

                if (filteredSpots.length === 0) {
                    spotsContainer.innerHTML = `<div class="no-results">${translations[currentLang].noResults}</div>`;
                    return;
                }

                filteredSpots.forEach(spot => {
                    const spotCard = document.createElement('div');
                    spotCard.className = `spot-card ${spot.categories[0]}-bg`;
                    
                    const title = spot.titles[currentLang];
                    const description = spot.descriptions[currentLang];
                    const directionText = translations[currentLang].directions[spot.direction];
                    const modelCourseTitle = translations[currentLang].modelCourse;
                    const timeRequired = spot.timeRequired[currentLang];
                    const budget = spot.budget[currentLang];
                    const bestSeason = spot.bestSeason[currentLang];
                    const modelCourseSteps = spot.modelCourses[currentLang];

                    const categoryTags = spot.categories.map(cat => {
                        const text = translations[currentLang].categories[cat];
                        return `<span class="category-tag ${cat}-tag">${text}</span>`;
                    }).join('');

                    spotCard.innerHTML = `
                        <div>
                            <img src="${spot.image}" alt="${title}" class="spot-image" loading="lazy">
                            <div class="spot-meta">
                                <span class="direction-tag">${directionText}</span>
                                ${categoryTags}
                                <div class="meta-item">
                                    ‚è± ${timeRequired}
                                </div>
                                <div class="meta-item">
                                    üí∞ ${budget}
                                </div>
                                <div class="meta-item">
                                    üëç ${bestSeason}
                                </div>
                            </div>
                        </div>
                        <div>
                            <h3 class="spot-title">${title}</h3>
                            <p>${description}</p>
                            <div class="model-course">
                                <h4>${modelCourseTitle}</h4>
                                ${modelCourseSteps.map(step => `<div class="course-step">${step}</div>`).join('')}
                            </div>
                        </div>
                    `;
                    
                    spotsContainer.appendChild(spotCard);
                });
            }
        });

        // „Çπ„ÇØ„É≠„Éº„É´ÊôÇ„Å´„Éà„ÉÉ„Éó„Å∏Êàª„Çã„Éú„Çø„É≥„ÇíË°®Á§∫/ÈùûË°®Á§∫
        window.addEventListener('scroll', function() {
            const scrollToTopBtn = document.getElementById('scrollToTopBtn');
            if (window.pageYOffset > 300) {
                scrollToTopBtn.style.display = 'block';
            } else {
                scrollToTopBtn.style.display = 'none';
            }
        });
    </script>
</body>
</html>